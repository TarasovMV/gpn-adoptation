<div>
<div class="container" >
  <div class="title">
    <div class="title__name">Моя адаптация</div>
    <div class="title__info" (click)="openPrompt()">
      <svg-icon src="assets/icon/progress/adaptation-info.svg"></svg-icon>
    </div>
  </div>
  <div class="content" style="overflow-y: scroll;">
    <div class="header">
      <div class="bar">
        <div class="progress" [ngStyle]="{'width.%': percentProgress * 100}"></div>
        <div class="bar__lock">
          <img class="bar__lock" src="assets/icon/progress/lock.svg"/>
        </div>
        <div class="bar__percent">
          <span>{{(percentProgress * 100).toFixed(0)}}%</span>
          <span class="task">Заданий выполнено</span>
        </div>
      </div>
      <div class="stages" id="stages">
        <div class="stage-block" *ngFor="let item of data?.adaptationStages">
          <div [id]="'stage_' + item.id" class="item ion-activatable ripple-parent"
               [ngClass]="{'item-active': (activeStage$ | async)?.id === item.id}" (click)="switchStage(item)">
            <ion-ripple-effect></ion-ripple-effect>
            <div class="item__title">
              <div class="item__header">{{item.name.toUpperCase()}}</div>
            </div>
            <div class="item__description">
              {{item?.description}}
            </div>
            <div class="item__icon">
              <cashed-img [src]="restUrl+'/'+item?.imagePath"></cashed-img>
            </div>
            <div class="item__stage">
              <div class="total"><span class="total__done">{{item.doneCount || 0}}</span> из
                {{item.adaptationSubStages?.length}}</div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="scroll">
      <div [@inOutAnimation] class="parallax" *ngIf="(activeStage$ | async)">
        <div *ngFor="let element of (activeStage$ | async).adaptationSubStages">
          <div class="stage ion-activatable ripple-parent" [ngClass]="{'stage-active': element.isDone, 'stage-disabled': element.disabled}"
               (click)="toProgressCard(element)">
            <ion-ripple-effect></ion-ripple-effect>
            <div style="display: flex; justify-content: center; align-items: center" class="stage__icon" [ngClass]="{'stage__icon-done': element.isDone}">
              <img class="icon-image"  *ngIf="element.isDone" src="assets/icon/progress/check.svg"/>
              <img class="icon-image" *ngIf="!element.isDone" src="assets/icon/progress/{{element.subStageType}}.svg"/>
            </div>

            <div class="stage__text">
              <div class="stage__text__name">{{element.name}}</div>
              <div class="timer">
                <div class="timer__logo">
                  <svg-icon src="assets/icon/progress/timer.svg"></svg-icon>
                </div>
                <span>{{element?.timeString}}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
</div>
